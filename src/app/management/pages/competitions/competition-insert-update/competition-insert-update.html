<div class="card shadow-sm p-3">
    <h5 class="card-title mb-3">
        {{ isEdit ? 'ویرایش مسابقه' : 'ایجاد مسابقه' }}
    </h5>

    <form class="row" [formGroup]="form" (ngSubmit)="save()">
        <div class="mb-3 col-6">
            <label class="form-label">عنوان</label>
            <input type="text" formControlName="competitionTitle" class="form-control">
        </div>

        <div class="mb-3 col-6">
            <label class="form-label">تاریخ</label>
            <app-date-picker [dateInput]="this.form.get('competitionDate')?.value"
                (dateChange)="onDateChange($event)" />
        </div>


        <div class="mb-3 col-6">
            <label class="form-label">محل برگزاری</label>
            <input type="text" formControlName="competitionAddress" class="form-control">
        </div>

        <div class="mb-3 col-3">
            <label class="form-label">بنر</label>
            <app-file-upload (fileUploaded)="onFileUploaded($event,'bannerFileId')" />
        </div>

        <div class="mb-3 col-3">
            <label class="form-label">گواهی برگزاری</label>
            <app-file-upload (fileUploaded)="onFileUploaded($event,'licenseFileId')" />
        </div>

        <div class="mb-3 form-check col-12 d-flex justify-content-start align-items-start">
            <button type="submit" class="btn btn-primary w-50">
                {{ isEdit ? 'ویرایش' : 'ایجاد' }}
            </button>
        </div>
    </form>

    <div *ngIf="message" class="mt-3 alert alert-info text-center   ">
        {{ message }}
    </div>
</div>

<div class="card shadow-sm p-3" *ngIf="isEdit">
    <h5 class="card-title mb-3">
        اطلاعات جداول
    </h5>
    <div class="mb-3 col-12" >
        <div class="card">
            <div class="card-header">
                <h6 class="card-title mb-0">JSON Parameters Editor</h6>
            </div>
            <div class="card-body">
                <form [formGroup]="jsonForm">
                    <div class="mb-3">
                        <label class="form-label">JSON Parameters</label>
                        <input type="text" class="form-control" formControlName="jsonParams"
                            placeholder='{"key": "value", "settings": {"option1": true, "option2": "text"}}'
                            [class.is-invalid]="jsonForm.get('jsonParams')?.invalid && jsonForm.get('jsonParams')?.touched">
                        <div class="invalid-feedback" *ngIf="jsonForm.get('jsonParams')?.errors?.['invalidJson']">
                            Invalid JSON format
                        </div>
                        <small class="text-muted">
                            Enter valid JSON parameters for the competition
                        </small>
                    </div>
                    <div class="d-flex justify-content-end">
                        <button type="button" class="btn btn-warning" (click)="updateCompetitionParams()"
                            [disabled]="jsonForm.invalid || !jsonForm.get('jsonParams')?.value?.trim()">
                            <i class="ti ti-upload me-1"></i>
                            Update Parameters
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>